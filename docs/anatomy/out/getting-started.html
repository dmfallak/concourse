<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Getting Started</title><link type="text/css" rel="stylesheet" href="public/anatomy.css" /><link type="text/css" rel="stylesheet" href="public/highlight.css" /><script type="text/javascript" src="public/jquery.js"></script><script type="text/javascript" src="public/jquery.hotkeys.js"></script><script type="text/javascript" src="public/tags_getting-started.js"></script><script type="text/javascript" src="public/main.js"></script></head><body class="normal"><div id="main"><div id="content"><div class="section" id="section_getting-started"><h1 class="section_header"><a name="getting-started"></a>Getting Started</h1><p>The <a href="https://github.com/concourse/concourse">Concourse repo</a> is a
<a href="https://github.com/cloudfoundry/bosh">BOSH</a> release containing
everything necessary to deploy to arbitrary infrastructures (or your laptop)
with largely the same configuration.</p><p>There are two ways to get started with Concourse:</p><ul><li><p><a href="getting-started.html#deploying-with-vagrant">With Vagrant</a> - for a quick deploy with
familiar tooling.</p></li><li><p><a href="getting-started.html#deploying-with-bosh">With BOSH</a> - for a scalable cluster, managed
by BOSH.</p></li></ul><p>There&#39;s no difference in Concourse&#39;s feature set between the two options.
Deploying with BOSH is the full extent of configurability and scalability,
but for just figuring out the semantics of your pipeline, or Concourse
itself, Vagrant will do just fine.</p><p>If you&#39;re not sure what you want yet, start with Vagrant while you kick the
tires a bit. It&#39;s easy to switch between these two deployment schemes later.
With Vagrant you&#39;ll get a single VM with everything on it, so it&#39;s very
quick to bootstrap.</p><div class="section" id="section_deploying-with-vagrant"><h2 class="section_header"><a name="deploying-with-vagrant"></a>Provisioning with Vagrant</h2><p>Before you go and spend money on hardware, you probably want to kick the tires a
bit.</p><p>The easiest way to get something up and running is to use the pre-built Vagrant
boxes. This requires no BOSH experience, but is otherwise exactly the same as a
BOSH deployment in terms of features.</p><p>Currently, only VirtualBox is supported. Pre-built AWS and VMware Fusion boxes
will be available in the future.</p><p>@; If you have no need for multiple workers, you can use a Vagrant provider like
@; AWS to spin up a single-instance deployment. This is perfectly fine for a lot
@; of use cases.</p><p>To spin up Concourse with Vagrant, run the following in any directory:</p><div class="highlight"><pre class="verbatim"><span class="t">vagrant</span><span class="t"> </span><span class="t">init</span><span class="t"> </span><span class="t">concourse/lite</span><span class="t"> </span><span class="c"># places Vagrantfile in current directory
</span><span class="t">vagrant</span><span class="t"> </span><span class="t">up</span><span class="t">                  </span><span class="t">#</span><span class="t"> </span><span class="t">downloads</span><span class="t"> </span><span class="t">the</span><span class="t"> </span><span class="t">box</span><span class="t"> </span><span class="t">and</span><span class="t"> </span><span class="t">spins</span><span class="t"> </span><span class="t">up</span><span class="t"> </span><span class="t">the</span><span class="t"> </span><span class="t">VM</span></pre></div><p>The web server will be running at <a href="http://192.168.100.4:8080">192.168.100.4:8080</a>.</p><p>Next, download the Fly CLI from the <a href="http://192.168.100.4:8080">main page</a> where
there are links to binaries for common platforms.</p><p><blockquote>If you&#39;re on Linux or OS X, you will have to <code>chmod +x</code> the downloaded
binary and put it in your <code>$PATH</code>.</blockquote></p><p>The default pipeline configuration is blank. You can see the current configuration by running:</p><div class="highlight"><pre class="verbatim"><span class="nv">$ </span><span class="t">fly</span><span class="t"> </span><span class="t">configure</span></pre></div><p>To configure a pipeline, fill in jobs and resources (see
eferencepipelines),
place the resulting config in a file, and run:</p><div class="highlight"><pre class="verbatim"><span class="nv">$ </span><span class="t">fly</span><span class="t"> </span><span class="t">configure</span><span class="t"> </span><span class="t">-c</span><span class="t"> </span><span class="t">path/to/pipeline.yml</span></pre></div><p>This will validate your pipeline config and immediately switch Concourse to it.</p><p>To run arbitrary tasks against the Vagrant box, see <a href="running-tasks.html">Tasks</a>.
</p></div><div class="section" id="section_deploying-with-bosh"><h2 class="section_header"><a name="deploying-with-bosh"></a>Deploying a cluster with BOSH</h2><p>@(require &quot;../common.rkt&quot;)</p><p>Once you start needing more workers and <em>really</em> caring about your CI
deployment, it&#39;s best to manage it with BOSH proper.</p><p>Using BOSH gives you a self-healing, predictable environment, that can be
scaled up or down by changing a single number.</p><p>The <a href="https://bosh.io/docs">BOSH documentation</a> outlines the
concepts, and how to bootstrap on various infrastructures.</p><p>
</p><div class="section" id="section_setting-up-the-infrastructure"><h3 class="section_header"><a name="setting-up-the-infrastructure"></a>Setting up the infrastructure</h3><p>Step one is to pick your infrastructure. AWS, vSphere, and OpenStack are fully
supported by BOSH.
<a href="https://github.com/cloudfoundry/bosh-lite">BOSH-Lite</a> is
a pseudo-infrastructure that deploys everything within a single VM. It is
a great way to get started with Concourse and BOSH at the same time, with
a faster feedback loop.</p><p>Concourse&#39;s infrastructure requirements are fairly straightforward. For
example, Concourse&#39;s own pipeline is deployed within an AWS VPC, with its web
instances automatically registered with an Elastic Load Balancer by BOSH.</p><p><a href="http://consul.io">Consul</a> is baked into the BOSH release, so that
you only need to configure static IPs for the Consul servers, and then
configure the Consul agents on the other jobs to join with the server. This
way you can have 100 workers without having to configure them 100 times.</p><div class="section" id="section_bosh-lite"><h4 class="section_header"><a name="bosh-lite"></a>BOSH-Lite</h4><p>Learning BOSH and your infrastructure at the same time will probably be hard.
If you&#39;re getting started with BOSH, you may want to check out
<a href="https://github.com/cloudfoundry/bosh-lite">BOSH-Lite</a> first,
which gives you a fairly BOSHy experience, in a single VM on your machine.
This is a good way to learn the BOSH tooling without having to pay hourly for
AWS instances.</p></div><div class="section" id="section_aws"><h4 class="section_header"><a name="aws"></a>AWS</h4><p>For AWS, it is recommended to deploy Concourse within a VPC, with the
<code>web</code> jobs sitting behind an ELB. Registering instances with the ELB is
automated by BOSH; you&#39;ll just have to create the ELB itself. This
configuration is more secure, as your CI system&#39;s internal jobs aren&#39;t exposed
to the outside world.</p></div><div class="section" id="section_vsphere-openstack"><h4 class="section_header"><a name="vsphere-openstack"></a>vSphere, OpenStack</h4><p>Deploying to vSphere and OpenStack should look roughly the same as the rest,
but this configuration has so far not seen any mileage. You may want to
consult the @hyperlink[&quot;http://docs.cloudfoundry.org/bosh/&quot;]BOSH
    documentation instead.</p></div></div><div class="section" id="section_deploying-and-upgrading-concourse"><h3 class="section_header"><a name="deploying-and-upgrading-concourse"></a>Deploying and upgrading Concourse</h3><p>Once you&#39;ve set up BOSH on your infrastructure, the following steps should get
you started:</p><div class="section" id="section_upload-the-stemcell"><h4 class="section_header"><a name="upload-the-stemcell"></a>Upload the stemcell</h4><p>A stemcell is a base image for your VMs. It controls the kernel and OS
distribution, and the version of the BOSH agent. For more information, consult
the <a href="http://bosh.io/docs/stemcell.html">BOSH documentation</a>.</p><p>To upload the latest AWS Trusty stemcell to your BOSH director, execute the
following:</p><div class="highlight"><pre class="verbatim"><span class="t">bosh</span><span class="t"> </span><span class="t">upload</span><span class="t"> </span><span class="t">stemcell</span><span class="t"> </span><span class="t">https://bosh.io/d/stemcells/bosh-aws-xen-hvm-ubuntu-trusty-go_agent</span></pre></div></div><div class="section" id="section_upload-the-concourse-and-garden-releases"><h4 class="section_header"><a name="upload-the-concourse-and-garden-releases"></a>Upload the Concourse &amp; Garden releases</h4><p>A release is a curated distribution of all of the source bits and
configuration necessary to deploy and scale a product. To learn more about
BOSH releases, refer to the
<a href="http://bosh.io/docs/release.html">BOSH documentation</a>.</p><p>A Concourse deployment currently requires two releases:
<a href="http://github.com/concourse/concourse">Concourse</a>&#39;s release
itself, and
@hyperlink[&quot;http://github.com/cloudfoundry-incubator/garden-linux-release&quot;]Garden
    Linux, which it uses for container management.</p><p>To upload the latest version of both releases, execute:</p><div class="highlight"><pre class="verbatim"><span class="t">bosh</span><span class="t"> </span><span class="t">upload</span><span class="t"> </span><span class="t">release</span><span class="t"> </span><span class="t">https://bosh.io/d/github.com/concourse/concourse</span><span class="t">
</span><span class="t">bosh</span><span class="t"> </span><span class="t">upload</span><span class="t"> </span><span class="t">release</span><span class="t"> </span><span class="t">https://bosh.io/d/github.com/cloudfoundry-incubator/garden-linux-release</span></pre></div><p>Note that as these are technically two separate releases, there is no
guarantee that they work together at all times. Concourse depends on Garden
Linux, and while each release does go through its own CI pipeline, there&#39;s
a chance that Garden Linux makes a backwards-incompatible change.</p><p>Currently the safest way to know which Garden Linux version to use is to go
to our
@hyperlink[&quot;https://github.com/concourse/concourse/releases/latest&quot;]latest
    GitHub release and grab Concourse and Garden-Linux from the <em>Downloads</em>
section. You can give these URLs directly to <code>bosh upload release</code> as
well.</p></div><div class="section" id="section_bosh-properties"><h4 class="section_header"><a name="bosh-properties"></a>Configure &amp; Deploy</h4><p>All you need to deploy your entire Concourse cluster is a BOSH deployment
manifest. This single document describes the desired layout of an entire
cluster.</p><p>The Concourse repo contains a few example manifests:</p><ul><li><p><a href="https://github.com/concourse/concourse/blob/master/manifests/bosh-lite.yml">BOSH Lite</a></p></li><li><p><a href="https://github.com/concourse/concourse/blob/master/manifests/aws-vpc.yml">AWS VPC</a></p></li></ul><p>If you reuse these manifests, you&#39;ll probably want to change the following
values:</p><ul><li><p><code>director_uuid</code>: The UUID of your deployment&#39;s BOSH director. Obtain
this with <code>bosh status --uuid</code>. This is a safeguard against deploying
to the wrong environments (the risk of making deploys so automated.)</p></li><li><p><code>networks</code>: Your infrastructure&#39;s IP ranges and such will probably be
different, but may end up being the same if you&#39;re using AWS with a VPC
that&#39;s the same CIDR block.</p></li><li><p><code>jobs.discovery.networks.X.static_ips</code>: A set of static IPs within
your network, used for each of the Consul servers.</p><p>When changing this, be careful to update each job&#39;s
<code>consul.agent.servers.lan</code> property to include the full set of IPs.</p><p>For a small-scale deployment, a single Consul server is probably fine. For
HA, you&#39;ll probably want to scale up to 3 or so. Refer to
<a href="http://consul.io">Consul</a>&#39;s documentation for more
information.</p></li><li><p><code>jobs.web.properties.atc.basic_auth_username</code>,
<code>jobs.web.properties.atc.basic_auth_encrypted_password</code>: Basic auth
credentials for the public web server.</p><p>The password must be a BCrypt-encrypted string. Note that higher encryption
costs may make the site less responsive.</p></li><li><p><code>jobs.web.properties.tsa.atc.username</code>,
<code>jobs.web.properties.tsa.atc.password</code>: Basic auth credentials to use when
registering the worker. These must be specified if basic auth is
configured, otherwise no workers will be available.</p><p>These are the same credentials as above, only in plaintext. Yes, it&#39;s kind
of silly. We&#39;d like to improve this in the future.</p></li><li><p><code>jobs.web.properties.atc.publicly_viewable</code>: Set to @codetrue to
make the webserver open (read-only) to the public. Destructive operations
are not permitted sensitive data is hidden when unauthenticated.</p></li><li><p><code>jobs.db.properties.postgresql.roles</code> and
<code>jobs.web.properties.atc.postgresql.role</code>: The credentials to the
PostgreSQL instance.</p></li><li><p><code>jobs.db.persistent_disk</code>: How much space to give PostgreSQL. You can
change this at any time; BOSH will safely migrate your persistent data to
a new disk when scaling up.</p></li><li><p><code>jobs.worker.instances</code>: Change this number to scale up or down the
number of worker VMs. Concourse will randomly pick a VM out of this pool
every time it starts a build.</p></li><li><p><code>resource_pools</code>: This is where you configure things like your EC2
instance type, the ELB to register your instances in, etc.</p></li></ul><p>You can change these values at any time and BOSH deploy again, and BOSH will do
The Right Thingâ„¢. It will tear down VMs as necessary, but always make sure
persistent data persists, and things come up as they should.</p><p>Once you have a deployment manifest, deploying Concourse should simply be:</p><div class="highlight"><pre class="verbatim"><span class="nv">$ </span><span class="t">bosh</span><span class="t"> </span><span class="t">deployment</span><span class="t"> </span><span class="t">path/to/manifest.yml</span><span class="t">
</span><span class="nv">$ </span><span class="t">bosh</span><span class="t"> </span><span class="t">deploy</span></pre></div><p>When new Concourse versions come out, upgrading should simply be a matter of
uploading the new releases and deploying again. BOSH will then kick off a
rolling deploy of your cluster.</p></div></div></div></div></div></div><div class="search"><form action="javascript:void(0)"><input type="text" placeholder="Search&hellip;" autocomplete="off" id="search" /></form><ul class="search_results"></ul></div><div id="sidebar"><h4>On this page:</h4><ol class="toc"><li><a href="getting-started.html#deploying-with-vagrant">Provisioning with Vagrant</a></li><li><a href="getting-started.html#deploying-with-bosh">Deploying a cluster with BOSH</a><ol><li><a href="getting-started.html#setting-up-the-infrastructure">Setting up the infrastructure</a><ol><li><a href="getting-started.html#bosh-lite">BOSH-Lite</a></li><li><a href="getting-started.html#aws">AWS</a></li><li><a href="getting-started.html#vsphere-openstack">vSphere, OpenStack</a></li></ol></li><li><a href="getting-started.html#deploying-and-upgrading-concourse">Deploying and upgrading Concourse</a><ol><li><a href="getting-started.html#upload-the-stemcell">Upload the stemcell</a></li><li><a href="getting-started.html#upload-the-concourse-and-garden-releases">Upload the Concourse &amp; Garden releases</a></li><li><a href="getting-started.html#bosh-properties">Configure &amp; Deploy</a></li></ol></li></ol></li></ol><h4>Up one level:</h4><ol class="toc"><li><a href="index.html">Concourse: CI that scales with your project</a><ol><li><a href="what-and-why.html">What &amp; Why</a><ol><li><a href="what-and-why.html#simple">Simple</a></li><li><a href="what-and-why.html#usable">Usable</a></li><li><a href="what-and-why.html#isolated-builds">Isolated Builds</a></li><li><a href="what-and-why.html#scalable-reproducible-deployment">Scalable, reproducible deployment</a></li><li><a href="what-and-why.html#flexible">Flexible</a></li><li><a href="what-and-why.html#local-iteration">Local iteration</a></li><li><a href="what-and-why.html#bootstrapped">Bootstrapped</a></li></ol></li><li><a href="concepts.html">Concepts</a><ol><li><a href="tasks.html">Tasks</a><ol><li><a href="tasks.html#runtime-environment">Runtime Environment</a></li></ol></li><li><a href="resources.html">Resources</a></li><li><a href="jobs.html">Jobs</a><ol><li><a href="jobs.html#job-builds">Builds</a></li></ol></li></ol></li><li><a href="getting-started.html">Getting Started</a><ol><li><a href="getting-started.html#deploying-with-vagrant">Provisioning with Vagrant</a></li><li><a href="getting-started.html#deploying-with-bosh">Deploying a cluster with BOSH</a><ol><li><a href="getting-started.html#setting-up-the-infrastructure">Setting up the infrastructure</a><ol><li><a href="getting-started.html#bosh-lite">BOSH-Lite</a></li><li><a href="getting-started.html#aws">AWS</a></li><li><a href="getting-started.html#vsphere-openstack">vSphere, OpenStack</a></li></ol></li><li><a href="getting-started.html#deploying-and-upgrading-concourse">Deploying and upgrading Concourse</a><ol><li><a href="getting-started.html#upload-the-stemcell">Upload the stemcell</a></li><li><a href="getting-started.html#upload-the-concourse-and-garden-releases">Upload the Concourse &amp; Garden releases</a></li><li><a href="getting-started.html#bosh-properties">Configure &amp; Deploy</a></li></ol></li></ol></li></ol></li><li><a href="fly-cli.html">The Fly CLI</a><ol><li><a href="fly-cli.html#targeting-your-concourse">Targeting your Concourse</a></li><li><a href="fly-cli.html#fly-save-target"><code>save-target</code>: Saving Concourse Targets</a></li><li><a href="fly-cli.html#fly-execute"><code>execute</code>: Submitting Local Tasks</a><ol><li><a href="fly-cli.html#multiple-inputs-to-locally-submitted-tasks">Multiple Inputs to Locally Submitted Tasks</a></li></ol></li><li><a href="fly-cli.html#fly-configure"><code>configure</code>: Configuring Pipelines</a><ol><li><a href="fly-cli.html#parameters">Parameters</a></li></ol></li><li><a href="fly-cli.html#fly-destroy-pipeline"><code>destroy-pipeline</code>: Removing Pipelines</a></li><li><a href="fly-cli.html#fly-intercept"><code>intercept</code>: Accessing a running or recent build&#39;s steps</a></li><li><a href="fly-cli.html#fly-sync"><code>sync</code>: Update your local copy of @codefly</a></li><li><a href="fly-cli.html#fly-watch"><code>watch</code>: View logs of in-progress builds</a></li></ol></li><li><a href="running-tasks.html">Tasks</a><ol><li><a href="running-tasks.html#configuring-tasks">Configuring a Task</a></li><li><a href="running-tasks.html#fly">Running tasks with <code>fly</code></a></li></ol></li><li><a href="pipelines.html">Piplines</a><ol><li><a href="configuring-resources.html"><code>resources</code>: Objects flowing through the pipeline</a></li><li><a href="configuring-jobs.html"><code>jobs</code>: Plans to execute against resources</a></li><li><a href="configuring-groups.html"><code>groups</code>: Splitting up your pipeline into sections</a></li></ol></li><li><a href="build-plans.html">Build Plans</a><ol><li><a href="get-step.html"><code>get</code>: fetch a resource</a></li><li><a href="put-step.html"><code>put</code>: update a resource</a></li><li><a href="task-step.html"><code>task</code>: execute a task</a></li><li><a href="aggregate-step.html"><code>aggregate</code>: run steps in parallel</a></li><li><a href="do-step.html"><code>do</code>: run steps in series</a></li><li><a href="step-conditions.html"><code>conditions</code>: conditionally perform a step</a></li></ol></li><li><a href="implementing-resources.html">Implementing a Resource</a><ol><li><a href="implementing-resources.html#check:-check-for-new-versions."><code>check</code>: Check for new versions.</a></li><li><a href="implementing-resources.html#in:-fetch-a-given-resource."><code>in</code>: Fetch a given resource.</a></li><li><a href="implementing-resources.html#out:-update-a-resource."><code>out</code>: Update a resource.</a></li></ol></li></ol></li></ol></div></body></html>